<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aussie Candy Finder</title>
  <!-- React and ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body, html {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      margin: 0;
      padding: 0;
      height: 100%;
      color: #1D252D;
    }
    
    /* IP Australia theme colors */
    :root {
      --teal: #25A9BC;
      --dark-blue: #1D252D;
      --light-mint: #E9F6F7;
      --white: #FFFFFF;
      --grey-light: #F2F2F2;
      --grey-medium: #666666;
      --grey-dark: #333333;
    }
    
    /* Header styles */
    .app-header {
      background-color: var(--dark-blue);
      color: white;
      padding: 1rem 2rem;
    }
    
    /* Main container */
    .content-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }
    
    /* Footer styles */
    .app-footer {
      background-color: var(--dark-blue);
      color: white;
      padding: 2rem;
      margin-top: 2rem;
    }
    
    /* Button styling */
    .btn-teal {
      background-color: var(--teal);
      color: white;
      border: none;
      padding: 0.5rem 1.5rem;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .btn-teal:hover {
      background-color: #1C8A9A;
    }
    
    /* Card styling */
    .ip-card {
      background-color: white;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }
    
    /* Form elements */
    input[type="checkbox"] {
      accent-color: var(--teal);
      width: 18px;
      height: 18px;
    }
    
    input[type="range"] {
      accent-color: var(--teal);
    }
    
    /* Background for question areas */
    .question-bg {
      background-color: var(--light-mint);
      border-radius: 5px;
      padding: 1.5rem;
    }
    
    /* Result bar styling */
    .result-bar {
      background-color: #E5E7EB;
      height: 8px;
      border-radius: 4px;
      overflow: hidden;
    }
    
    .result-bar-fill {
      background-color: var(--teal);
      height: 100%;
      border-radius: 4px;
    }
    
    /* Badge styling */
    .badge {
      background-color: #E9F6F7;
      color: var(--teal);
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    /* Typography */
    h1, h2, h3 {
      font-weight: 600;
    }
    
    h1 {
      font-size: 1.75rem;
      margin-bottom: 1.5rem;
      color: var(--dark-blue);
    }
    
    h2 {
      font-size: 1.25rem;
      margin-bottom: 1rem;
      color: var(--teal);
    }
    
    /* Override some Tailwind defaults */
    .text-teal {
      color: var(--teal) !important;
    }
    
    .bg-teal {
      background-color: var(--teal) !important;
    }
    
    .border-teal {
      border-color: var(--teal) !important;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="app-header flex items-center justify-between">
    <div class="flex items-center space-x-2">
      <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="18" cy="18" r="18" fill="#25A9BC"/>
        <path d="M13 13C13 11.3431 14.3431 10 16 10H20C21.6569 10 23 11.3431 23 13V23C23 24.6569 21.6569 26 20 26H16C14.3431 26 13 24.6569 13 23V13Z" fill="white"/>
        <path d="M18 15C19.1046 15 20 14.1046 20 13C20 11.8954 19.1046 11 18 11C16.8954 11 16 11.8954 16 13C16 14.1046 16.8954 15 18 15Z" fill="#25A9BC"/>
      </svg>
      <div>
        <div class="font-bold text-white">Aussie Candy</div>
        <div class="flex items-center">
          <span class="text-white text-sm">Finder</span>
          <span class="ml-2 px-2 py-0.5 bg-yellow-500 text-xs font-bold rounded text-black">ALPHA</span>
        </div>
      </div>
    </div>
    <nav class="hidden md:flex space-x-6">
      <a href="#" class="text-white hover:text-gray-300">Home</a>
      <a href="#" class="text-white hover:text-gray-300">About</a>
      <a href="#" class="text-white hover:text-gray-300">Learn more</a>
      <div class="flex items-center text-white">
        <span>Search</span>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5 ml-1">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
      </div>
    </nav>
  </header>

  <div id="root"></div>

  <!-- Footer -->
  <footer class="app-footer">
    <div class="max-w-6xl mx-auto">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <div class="flex items-center space-x-2 mb-4">
            <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="18" cy="18" r="18" fill="#25A9BC"/>
              <path d="M13 13C13 11.3431 14.3431 10 16 10H20C21.6569 10 23 11.3431 23 13V23C23 24.6569 21.6569 26 20 26H16C14.3431 26 13 24.6569 13 23V13Z" fill="white"/>
              <path d="M18 15C19.1046 15 20 14.1046 20 13C20 11.8954 19.1046 11 18 11C16.8954 11 16 11.8954 16 13C16 14.1046 16.8954 15 18 15Z" fill="#25A9BC"/>
            </svg>
            <div class="text-white">Aussie Candy</div>
          </div>
          <ul class="space-y-2 text-sm">
            <li><a href="#" class="text-white hover:text-gray-300">Home</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">Our confectionery</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">Contact us</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">FAQs</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">Working with us</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-white font-semibold mb-4">Candy Preferences</h3>
          <ul class="space-y-2 text-sm">
            <li><a href="#" class="text-white hover:text-gray-300">Chocolate lovers</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">Chewy treats</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">Caramel delights</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">Specialty confections</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-white font-semibold mb-4">Tools & Resources</h3>
          <ul class="space-y-2 text-sm">
            <li><a href="#" class="text-white hover:text-gray-300">Find specific candies</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">Learn about ingredients</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">View all candy options</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-white font-semibold mb-4">Provide Feedback</h3>
          <ul class="space-y-2 text-sm">
            <li><a href="#" class="text-white hover:text-gray-300">Send us an email</a></li>
            <li><a href="#" class="text-white hover:text-gray-300">Fill out a feedback form</a></li>
          </ul>
        </div>
      </div>
      
      <div class="flex justify-center md:justify-end space-x-4 mt-8">
        <a href="#" class="w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-white hover:bg-gray-700">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd" />
          </svg>
        </a>
        <a href="#" class="w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-white hover:bg-gray-700">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" />
          </svg>
        </a>
        <a href="#" class="w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center text-white hover:bg-gray-700">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
          </svg>
        </a>
      </div>
      
      <div class="text-center md:text-right mt-8 pt-8 border-t border-gray-700 text-sm text-gray-400">
        <div class="flex flex-col md:flex-row justify-center md:justify-end space-y-2 md:space-y-0 md:space-x-6">
          <a href="#" class="hover:text-white">Privacy</a>
          <a href="#" class="hover:text-white">Accessibility</a>
          <a href="#" class="hover:text-white">Disclaimer</a>
          <a href="#" class="hover:text-white">Security</a>
        </div>
        <div class="mt-4">© Commonwealth of Australia 2025</div>
      </div>
    </div>
  </footer>
  
  <!-- React Component -->
  <script type="text/babel">
    const AussieCandyHybridFinder = () => {
      // State for our data
      const [booleanQuestions, setBooleanQuestions] = React.useState([]);
      const [spectrumQuestions, setSpectrumQuestions] = React.useState([]);
      const [candies, setCandies] = React.useState([]);
      const [checkboxSelections, setCheckboxSelections] = React.useState({});
      const [sliderValues, setSliderValues] = React.useState({});
      const [rankedCandies, setRankedCandies] = React.useState([]);
      const [loading, setLoading] = React.useState(true);

      // Define which questions are boolean and which are spectrum
      const questionTypes = {
        boolean: [
          "Do you need biscuits?",
          "Something with crumbs?",
          "Shaped like an animal?",
          "Do you like floral Flavors?",
          "Can you accept something powdered?"
        ],
        spectrum: [
          "Do you want chocolate",
          "Do you like chewy things",
          "Something with caramel"
        ]
      };
      
      return (
        <div className="content-container">
          <div className="mb-6">
            <h1>Are you looking for the perfect Aussie candy?</h1>
            <p className="text-lg text-gray-600 mb-8">
              Find out which Australian candies match your preferences by answering a few simple questions.
            </p>
          </div>
          
          <div className="flex flex-col md:flex-row gap-6">
            {/* Left column - preferences */}
            <div className="w-full md:w-1/2 space-y-6">
              {/* Boolean Questions (Checkboxes) */}
              <div className="ip-card">
                <h2>What features are important to you?</h2>
                
                <div className="question-bg mt-4">
                  <div className="space-y-3">
                    {sortedBooleanQuestions.map((question, index) => (
                      <div 
                        key={index} 
                        className={`p-2 rounded-md transition-all ${checkboxSelections[question] ? 'bg-white' : ''}`}
                      >
                        <label className="flex items-center cursor-pointer">
                          <input
                            type="checkbox"
                            checked={checkboxSelections[question]}
                            onChange={() => toggleSelection(question)}
                            className="h-5 w-5 rounded"
                          />
                          <span className={`ml-3 ${checkboxSelections[question] ? 'font-medium text-teal' : ''}`}>
                            {question}
                          </span>
                        </label>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
              
              {/* Spectrum Questions (Sliders) */}
              <div className="ip-card">
                <h2>How important are these characteristics?</h2>
                
                <div className="question-bg mt-4">
                  <div className="space-y-6 py-2">
                    {spectrumQuestions.map((question, index) => (
                      <div key={index} className="mb-6">
                        <div className="flex justify-between items-center mb-2">
                          <label className="font-medium">{question}</label>
                          <span className={`text-sm font-medium badge ${sliderValues[question] !== 0 ? 'bg-teal text-white' : ''}`}>
                            {getPreferenceLabel(sliderValues[question])}
                          </span>
                        </div>
                        
                        <div className="relative">
                          <div className="w-full flex items-center justify-between text-xs text-gray-500 mb-1">
                            <span>Strongly Dislike</span>
                            <span>Neutral</span>
                            <span>Strongly Like</span>
                          </div>
                          
                          <input
                            type="range"
                            min="-5"
                            max="5"
                            step="1"
                            value={sliderValues[question]}
                            onChange={(e) => updateSliderValue(question, parseInt(e.target.value))}
                            className="w-full"
                          />
                          
                          <div className="w-full flex relative">
                            <div className="absolute left-0 w-full flex justify-between px-1">
                              {[-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5].map(tick => (
                                <div 
                                  key={tick} 
                                  className={`h-2 w-px ${tick === 0 ? 'bg-gray-500' : 'bg-gray-300'}`}
                                />
                              ))}
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
            
            {/* Right column - results */}
            <div className="w-full md:w-1/2">
              <div className="ip-card h-full">
                <h2>Recommended Candies</h2>
                
                <div className="mt-4 space-y-4 overflow-y-auto max-h-[calc(100vh-240px)]">
                  {rankedCandies.filter(candy => candy.score > 0).map((candy, index) => (
                    <div 
                      key={index} 
                      className="bg-white border border-gray-200 rounded-md shadow-sm overflow-hidden"
                    >
                      <div className="p-4 relative">
                        <div className="flex justify-between items-start">
                          <h3 className="font-semibold text-lg">{candy.name}</h3>
                          <span className="badge">
                            {Math.round(candy.score)}%
                          </span>
                        </div>
                        
                        <p className="text-sm text-gray-600 mt-1">{candy.description}</p>
                        
                        <div className="mt-3">
                          <div className="result-bar">
                            <div 
                              className="result-bar-fill" 
                              style={{ width: `${Math.min(100, Math.round(candy.score))}%` }}
                            />
                          </div>
                        </div>
                        
                        {/* Display matches and non-matches */}
                        <div className="mt-3 space-y-2 text-sm">
                          {/* Boolean matches */}
                          {candy.booleanMatches.length > 0 && (
                            <div className="flex items-start">
                              <span className="font-medium text-green-600 mr-1">Features:</span>
                              <span className="text-green-600">{candy.booleanMatches.join(', ')}</span>
                            </div>
                          )}
                          
                          {/* Boolean non-matches */}
                          {candy.booleanNonMatches.length > 0 && (
                            <div className="flex items-start">
                              <span className="font-medium text-red-500 mr-1">Missing:</span>
                              <span className="text-red-500">{candy.booleanNonMatches.join(', ')}</span>
                            </div>
                          )}
                          
                          {/* Spectrum matches */}
                          {candy.spectrumMatches.length > 0 && (
                            <div className="flex items-start">
                              <span className="font-medium text-teal mr-1">Good match for:</span>
                              <span className="text-teal">{candy.spectrumMatches.join(', ')}</span>
                            </div>
                          )}
                          
                          {/* Spectrum non-matches */}
                          {candy.spectrumNonMatches.length > 0 && (
                            <div className="flex items-start">
                              <span className="font-medium text-orange-500 mr-1">Less ideal for:</span>
                              <span className="text-orange-500">{candy.spectrumNonMatches.join(', ')}</span>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  ))}
                  
                  {rankedCandies.filter(candy => candy.score > 0).length === 0 && (
                    <div className="question-bg p-8 text-center">
                      {(sortedBooleanQuestions.some(q => checkboxSelections[q]) || spectrumQuestions.some(q => sliderValues[q] !== 0)) 
                        ? "No matching candies found. Try different preferences."
                        : "Select what you're looking for to get candy recommendations."}
                    </div>
                  )}
                </div>
              </div>
            </div>
          </div>
          
          <div className="mt-10 p-4 border-t border-gray-200 text-sm text-gray-500">
            <p>This Aussie Candy Finder has been designed to help candy enthusiasts navigate Australian confectionery options by making it visible, accessible, and easy to find information about factors involved in choosing the perfect treat.</p>
            <p className="mt-2">This tool does not provide dietary or nutritional advice, and none of the content should be regarded as recommending a specific candy.</p>
          </div>
        </div>
      );

      // Hardcoded data
      const candyData = {
        candies: [
          {
            name: "Cherry Ripe",
            description: "chocolate-covered cherry coconut bar",
            scores: {
              "Do you want chocolate": 1,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Fantales",
            description: "chocolate-covered caramel with trivia wrapper",
            scores: {
              "Do you want chocolate": 1,
              "Do you like chewy things": 1,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 0,
              "Something with caramel": 1
            }
          },
          {
            name: "Violet Crumble",
            description: "honeycomb toffee covered in chocolate",
            scores: {
              "Do you want chocolate": 1,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 1,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Minties",
            description: "chewy peppermint-flavored candy",
            scores: {
              "Do you want chocolate": 0,
              "Do you like chewy things": 3,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Caramello Koala",
            description: "chocolate koala filled with caramel",
            scores: {
              "Do you want chocolate": 2,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 1,
              "Something with caramel": 2
            }
          },
          {
            name: "Freckles",
            description: "chocolate discs covered in candy sprinkles",
            scores: {
              "Do you want chocolate": 2,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 1,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Fry's Turkish Delight",
            description: "rose-flavored jelly covered in chocolate",
            scores: {
              "Do you want chocolate": 1,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 1,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Redskins",
            description: "raspberry-flavored chewy candy",
            scores: {
              "Do you want chocolate": 0,
              "Do you like chewy things": 3,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Wizz Fizz",
            description: "sherbet powder candy",
            scores: {
              "Do you want chocolate": 0,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 2,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Freddo Frog",
            description: "frog-shaped chocolate",
            scores: {
              "Do you want chocolate": 3,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 1,
              "Something with caramel": 0
            }
          },
          {
            name: "Jaffas",
            description: "orange-flavored chocolate balls",
            scores: {
              "Do you want chocolate": 2,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Pollywaffles",
            description: "marshmallow and caramel wafer bar",
            scores: {
              "Do you want chocolate": 0,
              "Do you like chewy things": 0.5,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0.5,
              "Something with crumbs?": 1,
              "Shaped like an animal?": 0,
              "Something with caramel": 0.5
            }
          },
          {
            name: "Picnic",
            description: "chocolate bar with peanuts, caramel, and rice crisps",
            scores: {
              "Do you want chocolate": 1,
              "Do you like chewy things": 0.5,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0.5,
              "Something with crumbs?": 1,
              "Shaped like an animal?": 0,
              "Something with caramel": 3
            }
          },
          {
            name: "Musk Sticks",
            description: "pink, musk-flavored candy sticks",
            scores: {
              "Do you want chocolate": 0,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 1,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 0,
              "Something with crumbs?": 0,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          },
          {
            name: "Tim Tams",
            description: "chocolate-covered chocolate biscuit",
            scores: {
              "Do you want chocolate": 3,
              "Do you like chewy things": 0,
              "Do you like floral Flavors?": 0,
              "Can you accept something powdered?": 0,
              "Do you need biscuits?": 1,
              "Something with crumbs?": 1,
              "Shaped like an animal?": 0,
              "Something with caramel": 0
            }
          }
        ]
      };

      // Initialize data on component mount
      React.useEffect(() => {
        // Set questions by type
        setBooleanQuestions(questionTypes.boolean);
        setSpectrumQuestions(questionTypes.spectrum);
        
        // Initialize checkbox selections to all false (unchecked)
        const initialCheckboxes = {};
        questionTypes.boolean.forEach(question => {
          initialCheckboxes[question] = false;
        });
        
        // Initialize slider values to neutral (0)
        const initialSliders = {};
        questionTypes.spectrum.forEach(question => {
          initialSliders[question] = 0;
        });
        
        setCandies(candyData.candies);
        setCheckboxSelections(initialCheckboxes);
        setSliderValues(initialSliders);
        setLoading(false);
      }, []);

      // Calculate candy rankings whenever selections or slider values change
      React.useEffect(() => {
        if (loading) return;
        
        const rankCandies = () => {
          // Get selected checkbox questions
          const selectedBooleanQuestions = booleanQuestions.filter(q => checkboxSelections[q]);
          
          // Get non-zero slider questions
          const activeSpectrumQuestions = spectrumQuestions.filter(q => sliderValues[q] !== 0);
          
          // If no selections (checkboxes or sliders), all candies are shown with zero score
          if (selectedBooleanQuestions.length === 0 && activeSpectrumQuestions.length === 0) {
            return candies.map(candy => ({
              ...candy,
              score: 0,
              booleanMatches: [],
              booleanNonMatches: [],
              spectrumMatches: [],
              spectrumNonMatches: []
            }));
          }
          
          const ranked = candies.map(candy => {
            // Track boolean matches/non-matches
            const booleanMatches = [];
            const booleanNonMatches = [];
            let booleanScore = 0;
            
            // For each selected checkbox question, check if candy scores > 0
            selectedBooleanQuestions.forEach(question => {
              if ((candy.scores[question] || 0) > 0) {
                booleanMatches.push(question);
                booleanScore++;
              } else {
                booleanNonMatches.push(question);
              }
            });
            
            // Calculate boolean match percentage
            const booleanPercentage = selectedBooleanQuestions.length > 0 
              ? (booleanScore / selectedBooleanQuestions.length) * 100 
              : 100; // 100% if no boolean questions selected
            
            // Track spectrum matches/non-matches
            const spectrumMatches = [];
            const spectrumNonMatches = [];
            let spectrumScore = 0;
            let spectrumPossibleScore = 0;
            
            // Calculate spectrum match score
            activeSpectrumQuestions.forEach(question => {
              const candyValue = candy.scores[question] || 0;
              const preferenceValue = sliderValues[question];
              
              // Convert preference (-5 to 5) to expected score (0 to 3)
              const expectedValue = (preferenceValue > 0) 
                ? (preferenceValue / 5) * 3  // Map 1-5 to 0.6-3
                : 0;  // Negative values mean user doesn't want this
              
              // Calculate match (higher when candy matches expected value)
              const match = (preferenceValue > 0)
                ? Math.max(0, 3 - Math.abs(expectedValue - candyValue))
                : Math.max(0, 3 - candyValue);  // Reward low scores for negative preferences
              
              // Track if this is a good match
              const isGoodMatch = match > 1.5;
              
              if (isGoodMatch) {
                spectrumMatches.push(question);
              } else {
                spectrumNonMatches.push(question);
              }
              
              // Weight by strength of preference
              const weight = Math.abs(preferenceValue) / 5;
              spectrumScore += match * weight;
              spectrumPossibleScore += 3 * weight; // Max possible match is 3
            });
            
            // Calculate spectrum match percentage
            const spectrumPercentage = spectrumPossibleScore > 0 
              ? (spectrumScore / spectrumPossibleScore) * 100 
              : 100; // 100% if no spectrum questions active
            
            // Combine boolean and spectrum scores with equal weight
            const combinedScore = (booleanPercentage + spectrumPercentage) / 2;
            
            return {
              ...candy,
              score: combinedScore,
              booleanMatches,
              booleanNonMatches,
              spectrumMatches,
              spectrumNonMatches
            };
          });
          
          // Sort by score (descending)
          return ranked.sort((a, b) => b.score - a.score);
        };
        
        setRankedCandies(rankCandies());
      }, [checkboxSelections, sliderValues, booleanQuestions, spectrumQuestions, candies, loading]);

      // Toggle a checkbox selection
      const toggleSelection = (question) => {
        setCheckboxSelections({
          ...checkboxSelections,
          [question]: !checkboxSelections[question]
        });
      };
      
      // Update a slider value
      const updateSliderValue = (question, value) => {
        setSliderValues({
          ...sliderValues,
          [question]: value
        });
      };

      // Return loading screen if data not ready
      if (loading) {
        return <div className="flex items-center justify-center h-screen">Loading...</div>;
      }

      // Sort boolean questions to put selected ones at the top
      const sortedBooleanQuestions = [...booleanQuestions].sort((a, b) => {
        if (checkboxSelections[a] && !checkboxSelections[b]) return -1;
        if (!checkboxSelections[a] && checkboxSelections[b]) return 1;
        return 0;
      });

      // Helper function to get the preference text label for sliders
      const getPreferenceLabel = (value) => {
        if (value === 0) return "Neutral";
        if (value > 0) {
          return value < 3 ? "Yes" : value < 5 ? "Strongly Yes" : "Definitely Yes";
        } else {
          return value > -3 ? "No" : value > -5 ? "Strongly No" : "Definitely No";
        }
      };
